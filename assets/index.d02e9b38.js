import{g as O,A as S,b as w,y as M,z as j,B as G,x as K}from"./index.c3037d91.js";import{d as N,e as B,r as T,B as b,aD as x,aG as l,aH as e,u as a,C as D,aI as Q,aJ as W,bE as $,bF as H,b5 as J,b4 as R,b8 as q,a$ as X,c as Y,o as Z,F as P,aL as F,aM as A,ab as ee,aV as ae,bI as le,bA as te,bk as oe,bJ as ue}from"./arco.bfc06e8a.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css              */import{I as ne}from"./ImageUpload.73eb1717.js";import"./chart.8d130ef7.js";import"./vue.203b0a99.js";const ie=N({__name:"Edit",emits:["ok"],setup(L,{expose:g,emit:y}){const C=y,s=O(),r=B(),m=T({visible:!1,isCreate:!1,title:""}),t=B({type:0,username:void 0,email:void 0,nickname:void 0,avatar:void 0,gender:void 0,homePage:void 0,description:void 0,roleIds:void 0}),E=B(),U={type:[{required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237\u7C7B\u578B"}],nickname:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"}]},h=async()=>{r.value.resetFields(),m.isCreate=!0,m.title="\u65B0\u589E";try{await p()}catch(c){S(c)}m.visible=!0},d=async c=>{r.value.resetFields(),m.isCreate=!1,m.title="\u7F16\u8F91";try{t.value=await w.get(`/api/admin/user/${c}`),await p()}catch(o){S(o)}m.visible=!0},p=async()=>{E.value=await w.get("/api/admin/role/roles")},k=()=>{r.value.resetFields()},v=async c=>{if(await r.value.validate()){c(!1);return}try{const _=m.isCreate?"/api/admin/user/create":"/api/admin/user/update";await w.postForm(_,M(t.value)),j("\u63D0\u4EA4\u6210\u529F"),C("ok"),c(!0)}catch(_){S(_),c(!1)}};return g({show:h,showEdit:d}),(c,o)=>{const _=$,V=H,f=J,i=R,z=q,I=X;return b(),x(I,{visible:a(m).visible,"onUpdate:visible":o[9]||(o[9]=u=>a(m).visible=u),title:a(m).title,size:a(s).table.size,onCancel:k,onBeforeOk:v},{default:l(()=>[e(z,{ref_key:"formRef",ref:r,model:a(t),rules:U},{default:l(()=>[e(f,{label:"\u7C7B\u578B",field:"type"},{default:l(()=>[e(V,{modelValue:a(t).type,"onUpdate:modelValue":o[0]||(o[0]=u=>a(t).type=u),placeholder:"\u7528\u6237\u7C7B\u578B"},{default:l(()=>[e(_,{value:0,label:"\u7528\u6237"}),e(_,{value:1,label:"\u5458\u5DE5"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"\u6635\u79F0",field:"nickname"},{default:l(()=>[e(i,{modelValue:a(t).nickname,"onUpdate:modelValue":o[1]||(o[1]=u=>a(t).nickname=u)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u5934\u50CF",field:"avatar"},{default:l(()=>[e(ne,{modelValue:a(t).avatar,"onUpdate:modelValue":o[2]||(o[2]=u=>a(t).avatar=u)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u7528\u6237\u540D",field:"username"},{default:l(()=>[e(i,{modelValue:a(t).username,"onUpdate:modelValue":o[3]||(o[3]=u=>a(t).username=u)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u90AE\u7BB1",field:"email"},{default:l(()=>[e(i,{modelValue:a(t).email,"onUpdate:modelValue":o[4]||(o[4]=u=>a(t).email=u)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u6027\u522B",field:"gender"},{default:l(()=>[e(V,{modelValue:a(t).gender,"onUpdate:modelValue":o[5]||(o[5]=u=>a(t).gender=u)},{default:l(()=>[e(_,{value:"Male",label:"\u7537"}),e(_,{value:"Female",label:"\u5973"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"\u4E3B\u9875",field:"homePage"},{default:l(()=>[e(i,{modelValue:a(t).homePage,"onUpdate:modelValue":o[6]||(o[6]=u=>a(t).homePage=u)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u63CF\u8FF0",field:"description"},{default:l(()=>[e(i,{modelValue:a(t).description,"onUpdate:modelValue":o[7]||(o[7]=u=>a(t).description=u)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u89D2\u8272",field:"roles"},{default:l(()=>[e(V,{modelValue:a(t).roleIds,"onUpdate:modelValue":o[8]||(o[8]=u=>a(t).roleIds=u),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:l(()=>[(b(!0),D(W,null,Q(a(E),u=>(b(),x(_,{key:u.id,value:u.id,label:u.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","size"])}}}),se={class:"container"},de={class:"container-header"},re=P("div",{class:"action-btns"},null,-1),me={class:"container-main"},pe=["src"],ce={key:1},De=N({__name:"index",setup(L){const g=O(),y=B(!1),C=B(),s=T({limit:20,page:1,id:void 0,username:void 0,nickname:void 0,type:void 0}),r=T({page:{page:1,limit:20,total:0},results:[]}),m=Y(()=>({total:r.page.total,current:r.page.page,pageSize:r.page.limit,showTotal:!0,showJumper:!0,showPageSize:!0,pageSizeOptions:[20,50,100,200,300,500]}));Z(()=>{G()});const t=async()=>{y.value=!0;try{const d=await w.postForm("/api/admin/user/list",M(s));r.page=d.page,r.results=d.results}finally{y.value=!1}};t();const E=d=>{C.value.showEdit(d)},U=d=>{s.page=d,t()},h=d=>{s.limit=d,t()};return(d,p)=>{const k=R,v=J,c=$,o=H,_=ee,V=ae,f=q,i=le,z=te,I=oe,u=ue;return b(),D("div",se,[P("div",de,[e(f,{model:a(s),layout:"inline",size:a(g).table.size},{default:l(()=>[e(v,null,{default:l(()=>[e(k,{modelValue:a(s).id,"onUpdate:modelValue":p[0]||(p[0]=n=>a(s).id=n),placeholder:"\u7528\u6237ID"},null,8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(k,{modelValue:a(s).username,"onUpdate:modelValue":p[1]||(p[1]=n=>a(s).username=n),placeholder:"\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(k,{modelValue:a(s).nickname,"onUpdate:modelValue":p[2]||(p[2]=n=>a(s).nickname=n),placeholder:"\u6635\u79F0"},null,8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(o,{modelValue:a(s).type,"onUpdate:modelValue":p[3]||(p[3]=n=>a(s).type=n),placeholder:"\u7528\u6237\u7C7B\u578B","allow-clear":""},{default:l(()=>[e(c,{value:0,label:"\u7528\u6237"}),e(c,{value:1,label:"\u5458\u5DE5"})]),_:1},8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(V,{type:"primary","html-type":"submit",onClick:t},{icon:l(()=>[e(_)]),default:l(()=>[F(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1},8,["model","size"]),re]),P("div",me,[e(u,{loading:a(y),data:a(r).results,size:a(g).table.size,bordered:a(g).table.bordered,pagination:a(m),"sticky-header":!0,style:{height:"100%"},"column-resizable":"",onPageChange:U,onPageSizeChange:h},{columns:l(()=>[e(i,{title:"\u7F16\u53F7","data-index":"id"}),e(i,{title:"\u7C7B\u578B","data-index":"type"},{cell:l(({record:n})=>[n.type===1?(b(),x(z,{key:0,color:"blue"},{default:l(()=>[F("\u5458\u5DE5")]),_:1})):(b(),x(z,{key:1},{default:l(()=>[F("\u7528\u6237")]),_:1}))]),_:1}),e(i,{title:"\u5934\u50CF","data-index":"avatar"},{cell:l(({record:n})=>[e(I,null,{default:l(()=>[n.avatar?(b(),D("img",{key:0,src:n.avatar},null,8,pe)):(b(),D("span",ce,A(n.nickname),1))]),_:2},1024)]),_:1}),e(i,{title:"\u6635\u79F0","data-index":"nickname"}),e(i,{title:"\u90AE\u7BB1","data-index":"email"}),e(i,{title:"\u79EF\u5206","data-index":"score"}),e(i,{title:"\u662F\u5426\u7981\u8A00","data-index":"forbidden"},{cell:l(({record:n})=>[F(A(n.forbidden?"\u7981\u8A00":"-"),1)]),_:1}),e(i,{title:"\u6CE8\u518C\u65F6\u95F4","data-index":"createTime"},{cell:l(({record:n})=>[F(A(("useFormatDate"in d?d.useFormatDate:a(K))(n.createTime)),1)]),_:1}),e(i,{title:"\u64CD\u4F5C"},{cell:l(({record:n})=>[e(V,{type:"primary",size:a(g).table.size,onClick:_e=>E(n.id)},{default:l(()=>[F("\u7F16\u8F91")]),_:2},1032,["size","onClick"])]),_:1})]),_:1},8,["loading","data","size","bordered","pagination"])]),e(ie,{ref_key:"edit",ref:C,onOk:t},null,512)])}}});export{De as default};
