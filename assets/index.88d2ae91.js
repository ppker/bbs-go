import{j as O,a as M}from"./index.1d773328.js";import{d as T,e as V,r as B,B as x,aD as U,aG as a,aH as e,u as t,aL as b,b5 as I,b6 as A,bF as $,bG as j,b9 as G,b0 as J,c as R,o as K,C as q,F as w,aE as Q,aM as S,ab as W,aV as X,a5 as Y,bJ as Z,bC as ee,bK as te}from"./arco.2c5416d7.js";import{g as P,b as D,x as N,w as ae}from"./index.132414d9.js";/* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css              */import{I as oe}from"./ImageUpload.4ab24d0a.js";import{u as le}from"./height.78eba64d.js";import"./chart.a2535dd4.js";import"./vue.cdf9f1d2.js";const se=T({__name:"Edit",emits:["ok"],setup(H,{expose:_,emit:v}){const F=v,p=P(),n=V(),u=B({visible:!1,isCreate:!1,title:""}),o=V({name:void 0,description:void 0,logo:void 0,sortNo:void 0,status:void 0,createTime:void 0}),C={},y=()=>{n.value.resetFields(),u.isCreate=!0,u.title="\u65B0\u589E",u.visible=!0},h=async c=>{n.value.resetFields(),u.isCreate=!1,u.title="\u7F16\u8F91";try{o.value=await D.get(`/api/admin/topic-node/${c}`)}catch(l){N(l)}u.visible=!0},z=()=>{n.value.resetFields()},s=async c=>{if(await n.value.validate()){c(!1);return}try{const r=u.isCreate?"/api/admin/topic-node/create":"/api/admin/topic-node/update";await D.postForm(r,O(o.value)),ae("\u63D0\u4EA4\u6210\u529F"),F("ok"),c(!0)}catch(r){N(r),c(!1)}};return _({show:y,showEdit:h}),(c,l)=>{const r=I,f=A,g=$,E=j,k=G,d=J;return x(),U(d,{visible:t(u).visible,"onUpdate:visible":l[5]||(l[5]=i=>t(u).visible=i),title:t(u).title,size:t(p).table.size,onCancel:z,onBeforeOk:s},{default:a(()=>[e(k,{ref_key:"formRef",ref:n,model:t(o),rules:C},{default:a(()=>[e(f,{label:"\u540D\u79F0",field:"name"},{default:a(()=>[e(r,{modelValue:t(o).name,"onUpdate:modelValue":l[0]||(l[0]=i=>t(o).name=i)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u63CF\u8FF0",field:"description"},{default:a(()=>[e(r,{modelValue:t(o).description,"onUpdate:modelValue":l[1]||(l[1]=i=>t(o).description=i)},null,8,["modelValue"])]),_:1}),e(f,{label:"LOGO",field:"logo"},{default:a(()=>[e(oe,{modelValue:t(o).logo,"onUpdate:modelValue":l[2]||(l[2]=i=>t(o).logo=i)},null,8,["modelValue"])]),_:1}),e(f,{label:"\u6392\u5E8F",field:"sortNo"},{default:a(()=>[e(r,{modelValue:t(o).sortNo,"onUpdate:modelValue":l[3]||(l[3]=i=>t(o).sortNo=i)},null,8,["modelValue"])]),_:1}),e(f,{field:"status",label:"\u72B6\u6001"},{default:a(()=>[e(E,{modelValue:t(o).status,"onUpdate:modelValue":l[4]||(l[4]=i=>t(o).status=i)},{default:a(()=>[e(g,{value:0},{default:a(()=>[b("\u6B63\u5E38")]),_:1}),e(g,{value:1},{default:a(()=>[b("\u5220\u9664")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","size"])}}}),ie={class:"container"},ne={class:"container-header"},ue={class:"action-btns"},re={class:"container-main"},ze=T({__name:"index",setup(H){const _=P(),v=V(!1),F=V(),p=B({limit:20,page:1,name:void 0}),n=B({page:{page:1,limit:20,total:0},results:[]}),u=R(()=>({total:n.page.total,current:n.page.page,pageSize:n.page.limit,showTotal:!0,showJumper:!0,showPageSize:!0,pageSizeOptions:[20,50,100,200,300,500]}));K(()=>{le()});const o=async()=>{v.value=!0;try{const s=await D.postForm("/api/admin/topic-node/list",O(p));n.page=s.page,n.results=s.results}finally{v.value=!1}};o();const C=()=>{F.value.show()},y=s=>{F.value.showEdit(s)},h=s=>{p.page=s,o()},z=s=>{p.limit=s,o()};return(s,c)=>{const l=I,r=A,f=W,g=X,E=G,k=Y,d=Z,i=ee,L=te;return x(),q("div",ie,[w("div",ne,[e(E,{model:t(p),layout:"inline",size:t(_).table.size},{default:a(()=>[e(r,null,{default:a(()=>[e(l,{modelValue:t(p).name,"onUpdate:modelValue":c[0]||(c[0]=m=>t(p).name=m),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(g,{type:"primary","html-type":"submit",onClick:o},{icon:a(()=>[e(f)]),default:a(()=>[b(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1},8,["model","size"]),w("div",ue,[e(g,{type:"primary",size:t(_).table.size,onClick:C},{icon:a(()=>[e(k)]),default:a(()=>[b(" \u65B0\u589E ")]),_:1},8,["size"])])]),w("div",re,[e(L,{loading:t(v),data:t(n).results,size:t(_).table.size,bordered:t(_).table.bordered,pagination:t(u),"sticky-header":!0,style:{height:"100%"},"column-resizable":"",onPageChange:h,onPageSizeChange:z},{columns:a(()=>[e(d,{title:"\u7F16\u53F7","data-index":"id"}),e(d,{title:"\u540D\u79F0","data-index":"name"}),e(d,{title:"\u63CF\u8FF0","data-index":"description"}),e(d,{title:"LOGO","data-index":"logo"},{cell:a(({record:m})=>[m.logo?(x(),U(i,{key:0,width:"60",height:"60",fit:"cover",src:m.logo},null,8,["src"])):Q("",!0)]),_:1}),e(d,{title:"\u6392\u5E8F","data-index":"sortNo"}),e(d,{title:"\u72B6\u6001","data-index":"status"},{cell:a(({record:m})=>[b(S(m.status===0?"\u6B63\u5E38":"\u5220\u9664"),1)]),_:1}),e(d,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"createTime"},{cell:a(({record:m})=>[b(S(("useFormatDate"in s?s.useFormatDate:t(M))(m.createTime)),1)]),_:1}),e(d,{title:"\u64CD\u4F5C"},{cell:a(({record:m})=>[e(g,{type:"primary",size:t(_).table.size,onClick:de=>y(m.id)},{default:a(()=>[b("\u7F16\u8F91")]),_:2},1032,["size","onClick"])]),_:1})]),_:1},8,["loading","data","size","bordered","pagination"])]),e(se,{ref_key:"edit",ref:F,onOk:o},null,512)])}}});export{ze as default};
